"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9932],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return k}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),m=p(n),k=r,d=m["".concat(s,".").concat(k)]||m[k]||c[k]||i;return n?a.createElement(d,l(l({ref:t},u),{},{components:n})):a.createElement(d,l({ref:t},u))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},307:function(e,t,n){n.r(t),n.d(t,{assets:function(){return s},contentTitle:function(){return l},default:function(){return c},frontMatter:function(){return i},metadata:function(){return o},toc:function(){return p}});var a=n(3117),r=(n(7294),n(3905));const i={},l=void 0,o={unversionedId:"Cibersecurity/Red Team/Tools/Nmap",id:"Cibersecurity/Red Team/Tools/Nmap",title:"Nmap",description:"Common switches",source:"@site/docs/Cibersecurity/Red Team/Tools/Nmap.md",sourceDirName:"Cibersecurity/Red Team/Tools",slug:"/Cibersecurity/Red Team/Tools/Nmap",permalink:"/docs/Cibersecurity/Red Team/Tools/Nmap",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Metasploit",permalink:"/docs/Cibersecurity/Red Team/Tools/Metasploit"},next:{title:"Hack with Powershell",permalink:"/docs/Cibersecurity/Red Team/Windows/Hack with Powershell"}},s={},p=[{value:"Common switches",id:"common-switches",level:3},{value:"Live Host Discovery and Port Scan",id:"live-host-discovery-and-port-scan",level:2},{value:"Basisc scan types",id:"basisc-scan-types",level:3},{value:"ICMP Network Scanning",id:"icmp-network-scanning",level:3},{value:"Port specification",id:"port-specification",level:3},{value:"Service and Version Detection",id:"service-and-version-detection",level:3},{value:"OS Detection",id:"os-detection",level:3},{value:"Timing and Performance (0-5) Default 3",id:"timing-and-performance-0-5-default-3",level:3},{value:"Getting More Details",id:"getting-more-details",level:3},{value:"Firewall Evasion",id:"firewall-evasion",level:3},{value:"Spoofing and Decoys",id:"spoofing-and-decoys",level:3},{value:"Detect live hosts",id:"detect-live-hosts",level:3},{value:"Disable Host discovery",id:"disable-host-discovery",level:3},{value:"Post Port Scan",id:"post-port-scan",level:2},{value:"Service Detection",id:"service-detection",level:3},{value:"OS Detection",id:"os-detection-1",level:3},{value:"Traceroute",id:"traceroute",level:3},{value:"NSE Scripts",id:"nse-scripts",level:3},{value:"Saving the Output",id:"saving-the-output",level:3},{value:"Examples",id:"examples",level:3}],u={toc:p};function c(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h3",{id:"common-switches"},"Common switches"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://www.stationx.net/nmap-cheat-sheet/"},"Nmap Cheat Sheet")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"live-host-discovery-and-port-scan"},"Live Host Discovery and Port Scan"),(0,r.kt)("h3",{id:"basisc-scan-types"},"Basisc scan types"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-sT")," TCP Connect Scans  (Default)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-sS"),' SYN "Half-open" Scans. With sudo (Default when using sudo)'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-sU")," UDP Scans. With sudo"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-sN")," TCP Null Scans. No response, port open or filtered."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-sF")," TCP FIN Scans. No response, port open or filtered."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-sX")," TCP Xmas Scans. No response, port open or filtered."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-sA")," TCP ACK Scan. The target would respond to the ACK with RST regardless of the port. FIREWALL EVASION. We can learn wich ports are not filtered.")),(0,r.kt)("h3",{id:"icmp-network-scanning"},"ICMP Network Scanning"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"nmap -sn 10.10.0.(1-254 or /24)"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("strong",{parentName:"li"},"-sn")," switch tells Nmap not to scan any ports ")))),(0,r.kt)("h3",{id:"port-specification"},"Port specification"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-p 21")," Port 21"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-p 21-100")," Port range"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-p-")," Scan all ports (The 65535)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"--top-ports 2000")," Scan the top 200 ports"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-F")," Most commont 100 ports")),(0,r.kt)("h3",{id:"service-and-version-detection"},"Service and Version Detection"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-sV")," Attempts to determine the version of the service running on port"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-A")," Enable OS detection, version detection, script scanning, and traceroute")),(0,r.kt)("h3",{id:"os-detection"},"OS Detection"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-O")," Remote OS detection using TCP/IP stack fingerprinting")),(0,r.kt)("h3",{id:"timing-and-performance-0-5-default-3"},"Timing and Performance (0-5) Default 3"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-T0")," Paranoid IDS evasion. 5 minutes between each probe."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-T4")," Often used during CTFs"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-T5")," Insane speeds scan (extraordinarily fast network)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"--min-rate 15"),". Rate >= 15 packets/sec"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"--max-rate 50"),". Rate <= 50 packets/sec"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"--min-parallelism 100")," At least 100 probes in parallel")),(0,r.kt)("h3",{id:"getting-more-details"},"Getting More Details"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"--reason"),". Gives us the explicit reason why Nmap concluded that the system is up or a particular port is open."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-v")," or ",(0,r.kt)("strong",{parentName:"li"},"-vv")," verbosity"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-d")," or ",(0,r.kt)("strong",{parentName:"li"},"-dd")," debuggin")),(0,r.kt)("h3",{id:"firewall-evasion"},"Firewall Evasion"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-f")," Fragment packets in 8 Bytes"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"--mtu number")," Must be a multiple of 8"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},'--scan-delay "time"ms')," Used to add a delay between packets sent"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"--badsum")," Used to generate an invalid checksum for packets. Instead of dropping it, firewalls may respond automatically, without bothering to check the checksum of the packet. Can be used to determine the presence of a firewall/IDS. ")),(0,r.kt)("h3",{id:"spoofing-and-decoys"},"Spoofing and Decoys"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"nmap -S SPOOFED_IP 10.10.208.223"),". Only works if we can monitor the network for responses."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"nmap -e NET_INTERFACE -S SPOOFED_IP 10.10.208.223")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"nmap --spoof-mac SPOOFED_MAC -e NET_INTERFACE -S SPOOFED_IP 10.10.208.223")," Only works in the same subnet."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"nmap -D 10.10.0.1,10.10.0.2,RND,RND,ME 10.10.208.223")," -D is decoy ip(another IP that send the packages). RND is random IP. ME is my ip. The last one is the destination IP."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"nmap -sI ZOMBIE_IP 10.10.208.223")," To use an Idle/Zombie Scan")),(0,r.kt)("h3",{id:"detect-live-hosts"},"Detect live hosts"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-PR -sn")," ARP Scan. In the same subnet"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-PE -sn")," ICMP Echo Scan. Usually blocked"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-PP -sn")," ICMP Timestamp Scan. Expect ICMP Type 14. Usefull to bypass the Echo block."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-PM -sn")," ICMP Adress Mask Scan. Similar to -PP, type 18."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-PS22,80,443 -sn")," TCP SYN Ping Scan. Use with sudo to avoid 3-way handshake. GOOD RESULTS "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-PA22,80,443 -sn")," TCP ACK Ping Scan. Expect RST."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-PU53,161,162 -sn")," UDP Ping Scan. Expect the response of a closed port from an active host.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-sn")," Host discovery only"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-n")," no DNS lookup"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-R")," reverse-DNS lookup for all hosts")))),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"disable-host-discovery"},"Disable Host discovery"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-Pn")," Host discovery disabled")),(0,r.kt)("h2",{id:"post-port-scan"},"Post Port Scan"),(0,r.kt)("h3",{id:"service-detection"},"Service Detection"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-sV")," Service and version information for open ports. -sS is not possible when using -sV. TCP 3-WHandshake must be done",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"--version-intensity LEVEL")," Between 0 and 9.")))),(0,r.kt)("h3",{id:"os-detection-1"},"OS Detection"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-O"))),(0,r.kt)("h3",{id:"traceroute"},"Traceroute"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"--traceroute")," Starts with a packet of low TTL and keeps increasing until it reaches the target.")),(0,r.kt)("h3",{id:"nse-scripts"},"NSE Scripts"),(0,r.kt)("p",null,"There are many categories available: ",(0,r.kt)("a",{parentName:"p",href:"https://nmap.org/book/nse-usage.html"},"NSE")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-sC")," or ",(0,r.kt)("strong",{parentName:"li"},"--script=default")," Run the scripts in default")),(0,r.kt)("p",null,"Usage: --script=script-name"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"--script=safe"),"  "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"--script=smb-enum-users, smb-enum-shares")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},'--script "ftp*"')," patern")),(0,r.kt)("p",null,"Where can i find the scripts? /usr/share/nmap/scripts and /usr/share/nmap/scripts/script.db"),(0,r.kt)("h3",{id:"saving-the-output"},"Saving the Output"),(0,r.kt)("p",null,"There are 3 formats: normal, grepable and XML."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-oN FILENAME")," Normal format"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-oG FILENAME")," Grepable format. ",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"grep KEYWORD TEXT_FILE")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-oX")," XML Format. To process the output in other programs."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"-oA")," All three formats")),(0,r.kt)("h3",{id:"examples"},"Examples"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"sudo nmap -Pn -A -T5 IPDEST"))))}c.isMDXComponent=!0}}]);